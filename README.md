# WebGLとは（研究のための学習）
## 勘違いされていること

- 総合的な3D APIだと思われてる
  - 単なるラスタライゼーションエンジン
    - 入力されたコードに従ってポイントやライン、トライアングルを描画するだけ

## POINT
- WebGLはGPUで処理される
  - コードは組となる2つの関数として与える必要がある
    - 頂点シェーダ
    - フラグメントシェーダ
  - これらをGLSLという言語で記述できる。この二つを合わせたものをプログラムという

### 頂点シェーダ
- 頂点アトリビュートを計算する
  
様々な座標に応じ、この関数はポイントやライン、トライアングルを含む多様なプリミティブなラスタライズに必要な値を出力する。
２つ目のユーザ定義関数、フラグメントシェーダがこれらのプリミティブをラスタライズするために呼び出される
そのフラグメントシェーダが担当するのが描画中の**プリミティブの各ピクセルの色を計算すること**

**WebGL APIのほぼすべてはこれら２関数の実行に必要なステートの設定**に関すること
描画対象のそれぞれについて、ステートを設定し、drawArrays関数からdrawElements関数を呼び出して、GPU上でシェーダを実行する

## WebGLのレンダリングパイプライン上にある各項目について

### 頂点バッファオブジェクト
描画対象のジオメトリを定義するデータを保持する
通常は3Dオブジェクトの頂点を表す座標が保持され
WebGL内で頂点バッファオブジェクトとして処理される
他にも頂点バッファオブジェクトとしてモデリングできるものには頂点の法線、色、テクスチャ座標などの要素がある

### インデックスバッファオブジェクト
頂点バッファオブジェクトがジオメトリの頂点を保持する一方、インデックスバッファオブジェクトはレンダリングパイプラインが描画プリミティブを構築するときに使用する
頂点同士の関係を保持する
つまり、このバッファ内の値は頂点バッファ内の各頂点のインデックスとして解釈される

### 頂点シェーダ
各頂点に対して呼び出される
このシェーダは頂点座標や法線、色、テクスチャ座標などの頂点ごとのデータを操作する
これらのデータは頂点シェーダ内でアトリビュートとして扱われる
それぞれのアトリビュートは頂点データを読み取る
頂点バッファオブジェクトと関連付けられている

### フラグメントシェーダ
3つの頂点を組み合わせると三角形となる
この三角形の表面全体に色を設定しなければならない
そうしないと物体表面に色がつかない
表面の各要素はフラグメントと呼ばれる
表面はスクリーン上に描画されるので、より一般的にはそれらの要素はピクセルと呼ばれる
フラグメントシェーダの主な目的はそれぞれのピクセルの色を計算すること

### フレームバッファ
フラグメントシェーダによって処理されたフラグメントを保持する二次元のバッファ
全フラグメントの処理が完了すると、画像が生成されて、スクリーンに表示される
フレームバッファがレンダリングパイプラインの最終出力先

### アトリビュート
頂点シェーダで使用される入力変数
アトリビュートにはバッファからどのように取り出すかが指定されていて、その指定に基づき、頂点シェーダにデータを提供する
例えば、一つの頂点ごとにバッファ内の三つの三十二ビットの浮動小数点数を関連づけることで、バッファのデータを三次元の座標として
使用できる。
特定のアトリビュートに対して
− どのバッファから値を取り出すか
- 取り出して使用されるデータの型は何か
- バッファから取り出し始めるオフセットはいくつか
- 次の位置までのバイト数はいくつか
を指定できる。
頂点シェーダは頂点ごとに呼び出されるので、アトリビュートの値は頂点シェーダが実行されるたびに異なります

### ユニフォーム
頂点シェーダとフラグメントシェーダの両方で利用できる入力変数
アトリビュートとは異なり、ユニフォームは一度のレンダリングサイクル中は値が変わりません。
よくユニフォームとしてモデリングされる値として、光源の位置がある。
実質的にはシェーダプログラムを実行する前にせて値するグローバル変数とも言える

###　テクスチャ
シェーダプログラム内からアクセスできる配列状のデータ
テクスチャが保持する値としては画像データが最も一般的だが、実際にはテクスチャは単なる数値データで
画像を表現する色以外の値も問題なく保持可能

###　バリイング
頂点シェーダからフラグメントシェーダにデータを受け渡すために使用する変数
頂点シェーダがバリイングに設定した値はポイント、ライン、トライアングルなど描画している要素に応じて、フラグメントシェーダに渡される際に補完される

## WebGL内での描画
ジオメトリをその複雑さや頂点の数によらず統一的な方法で扱う
あらゆる3Dオブジェクトのジオメトリを表現する基礎となるデータは
- 頂点
- インデックス
の二つ

###　頂点
オブジェクトの角を定義する点
各頂点の三次元座標に対応する浮動小数点数で表現される
頂点は全て配列で記述する必要がある
その配列を使用して、頂点バッファが構築される

###　インデックス
与えられた3Dシーン内の頂点のラベルとなる数値
インデックスを使用して頂点をどのように接続して面を構成かを伝えられる
頂点と同様にインデックスも配列として保持され、インデックスバッファを通してレンダリングパイプラインに引き渡される

